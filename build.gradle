apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'objective-c'


repositories {
    mavenCentral()
}

dependencies {
    testCompile('junit:junit:4.12')
    compile "net.java.dev.jna:jna:4.5.0"
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

test {
    systemProperty "java.library.path", file("${buildDir}/libs/nst/shared").absolutePath
}


model {
    platforms {
        x64 {
            architecture "x64"
        }
    }

    components {
            nst(NativeLibrarySpec) {
            binaries.all {
                    if (targetPlatform.operatingSystem.macOsX) {
                        cCompiler.args '-framework', 'Foundation'
                        linker.args '-framework', "Cocoa"
                    } else {
                    throw new GradleException("Unsupported platform")
                }
            }
        }
    }
}

test.dependsOn  'nstSharedLibrary'

